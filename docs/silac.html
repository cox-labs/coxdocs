<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.315">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Cox Lab">
<meta name="dcterms.date" content="2024-03-18">

<title>SILAC data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./Figures/coxlab_logo2.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./maxquant_instructions.html"> 
<span class="menu-text">MaxQuant</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./perseus_instructions.html"> 
<span class="menu-text">Perseus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./andromeda_instructions.html"> 
<span class="menu-text">Andromeda</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="./contact.html"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/cox-labs/CoxLab_Bug_Reporting"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/TheCoxLab"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/juergen-cox-2437ba17/"> <i class="bi bi-fa-linkedin fa-lg" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#dataset" id="toc-dataset" class="nav-link active" data-scroll-target="#dataset"><span class="header-section-number">1</span> Dataset</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">2</span> Data preparation</a>
  <ul>
  <li><a href="#loading" id="toc-loading" class="nav-link" data-scroll-target="#loading"><span class="header-section-number">2.1</span> Loading</a></li>
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering"><span class="header-section-number">2.2</span> Filtering</a></li>
  <li><a href="#ratio-transformation" id="toc-ratio-transformation" class="nav-link" data-scroll-target="#ratio-transformation"><span class="header-section-number">2.3</span> Ratio transformation</a></li>
  <li><a href="#renaming-columns" id="toc-renaming-columns" class="nav-link" data-scroll-target="#renaming-columns"><span class="header-section-number">2.4</span> Renaming columns</a></li>
  </ul></li>
  <li><a href="#add-annotation" id="toc-add-annotation" class="nav-link" data-scroll-target="#add-annotation"><span class="header-section-number">3</span> Add annotation</a></li>
  <li><a href="#scatter-plot" id="toc-scatter-plot" class="nav-link" data-scroll-target="#scatter-plot"><span class="header-section-number">4</span> Scatter plot</a></li>
  <li><a href="#density-scatter-plot" id="toc-density-scatter-plot" class="nav-link" data-scroll-target="#density-scatter-plot"><span class="header-section-number">5</span> Density scatter plot</a></li>
  <li><a href="#multi-scatter-plot" id="toc-multi-scatter-plot" class="nav-link" data-scroll-target="#multi-scatter-plot"><span class="header-section-number">6</span> Multi scatter plot</a></li>
  <li><a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram"><span class="header-section-number">7</span> Histogram</a></li>
  <li><a href="#profile-plot" id="toc-profile-plot" class="nav-link" data-scroll-target="#profile-plot"><span class="header-section-number">8</span> Profile plot</a></li>
  <li><a href="#d-scatter-plot" id="toc-d-scatter-plot" class="nav-link" data-scroll-target="#d-scatter-plot"><span class="header-section-number">9</span> 3D scatter plot</a></li>
  <li><a href="#grouping-of-samples" id="toc-grouping-of-samples" class="nav-link" data-scroll-target="#grouping-of-samples"><span class="header-section-number">10</span> Grouping of samples</a></li>
  <li><a href="#numeric-venn-diagram" id="toc-numeric-venn-diagram" class="nav-link" data-scroll-target="#numeric-venn-diagram"><span class="header-section-number">11</span> Numeric Venn diagram</a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova"><span class="header-section-number">12</span> ANOVA</a></li>
  <li><a href="#enrichment-fisher-exact-test" id="toc-enrichment-fisher-exact-test" class="nav-link" data-scroll-target="#enrichment-fisher-exact-test"><span class="header-section-number">13</span> Enrichment, Fisher exact test</a></li>
  <li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering"><span class="header-section-number">14</span> Hierarchical clustering</a></li>
  <li><a href="#principal-component-analysis" id="toc-principal-component-analysis" class="nav-link" data-scroll-target="#principal-component-analysis"><span class="header-section-number">15</span> Principal component analysis</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SILAC data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Cox Lab </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 18, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>

<p>For the here shown use case Perseus 1.5.1.6 was used.</p>
<section id="dataset" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Dataset</h1>
<p>The SILAC data for the here shown example was published in 2010 by Geiger et. al.<span class="citation" data-cites="geiger2012"><sup><a href="#ref-geiger2012" role="doc-biblioref">1</a></sup></span>.</p>
<p>The dataset consists of three breast cancer cell lines measured in triplicates. Each sample was separated into 12 OFFGEL fractions. This resulted in 108 two-hour LC-MS runs. The samples were measured with SILAC as an external standard. The light state (Lys-0/Arg-0) is the respective sample, while the heavy state (Lys-8/Arg-10) is always the same mixture for all cell lines.</p>
<!-- 
The files "20070522_NH_Orbi2_HelaEpo_01.RAW" and "20070522_NH_Orbi2_HelaEpo_02.RAW" were processed using MaxQuant version 1.5.2.0 and analyzed using Perseus version 1.5.1.6.
-->
</section>
<section id="data-preparation" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data preparation</h1>
<section id="loading" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="loading"><span class="header-section-number">2.1</span> Loading</h2>
<p>Load the file “proteinGroups.txt” from the “combined/txt” folder of the MaxQuant output. <a href="genericmatrixupload.html">Load → Generic matrix upload</a> is denoted by the green arrow on the top left corner of the Perseus window or load the file using the drag and drop function of Perseus.</p>
<p><img src="images/silac-01-generic_matrix_upload-edited.png" class="img-fluid"></p>
<p>Make sure you select the 9 “Ratio H/L Normalized …” columns as main columns. Also make sure you understand what is meant by the column types “Main”, “Categorical”, “Numerical”, “Multi-numerical” and “Text”.</p>
<p><em>Comment: After each applied operation a new matrix will be generated. Every matrix that you are creating can be saved with <a href="tabseparatedexport.html">Export → Generic matrix export</a> and re-imported later with <a href="genericmatrixupload.html">Load → Generic matrix upload</a>.</em></p>
</section>
<section id="filtering" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="filtering"><span class="header-section-number">2.2</span> Filtering</h2>
<p>After loading the matrix, we filter out the reverse proteins and the proteins that are only identified by site. This is done by using the function <a href="filtercategoricalcolumn.html">Processing → Filter rows → Filter rows based on categorical column</a>, because both the “Reverse” column and the “Only identified by site” column are categorical.</p>
<p><img src="images/silac-02-filter_categorical_column-edited.png" class="img-fluid"></p>
<p>First, we filter out the reverse hits. Reverse hits are indicated by a “+” in the “Reverse” column, so to filter out these hits all rows containing a “+” will be removed from the matrix. Therefore, the column “Reverse” needs to be selected, “+” is the value we are looking for and is selected by default. No further changes need to be applied, because we want to remove the matching rows from the matrix. This results in a matrix, where the value in the “Reverse” column of all rows is empty.</p>
<p><img src="images/silac-02-filter_categorical_column-reverse.png" class="img-fluid"></p>
<p>Second, we filter out the hits that are only identified by site. The column “Only identified by site” has two values, TRUE and FALSE. Thus all rows containing TRUE are filtered out. Therefore, “Only identified by site” has to be selected as column and TRUE is the value of interest, which is selected by clicking on TRUE on the left hand side and using the button in the middle with the arrow to the right on it. Deselection works by using the button with the arrow to the left. No further changes are necessary, because we want to remove the matching rows from the matrix. This results in a matrix, where all rows contain the value FALSE in the column “Only identified by site”.</p>
<p><img src="images/silac-02-filter_categorical_column-only_identified_by_site-01.png" class="img-fluid"></p>
<p>The next step is to filter out all rows with less than six valid intensity values of all nine (i.e.&nbsp;being not NaN). Therefore we use <a href="filtervalidvaluesrows.html">Processing → Filter rows → Filter rows based on valid values</a>.</p>
<p><img src="images/silac-05-filter_valid_values-edited.png" class="img-fluid"></p>
<p>The required percentage of valid values per row may differ from study to study. In some cases, having valid values only in one of several replicate groups might be a significant finding and these kind of rows should possibly not be discarded. The filter can also be applied to each column group separately. (How to create column groups or categorical annotation rows you will learn in a few steps.) Now we just want to be certain that each row contains at least six of the nine intensity values.</p>
<p><img src="images/silac-05-filter_valid_values-parameter_window.png" class="img-fluid"></p>
</section>
<section id="ratio-transformation" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="ratio-transformation"><span class="header-section-number">2.3</span> Ratio transformation</h2>
<p>Because the actual sample is in the light SILAC channel and the reference is in the heavy channel, we need to invert the ratios using <a href="transformationproc">Processing → Basic → Transform</a>.</p>
<p><img src="images/silac-03-transformation-edited.png" class="img-fluid"></p>
<p>To invert the ratios the formula <span class="math inline">\(1/x\)</span> has to be typed in the transformation type field. No further changes are necessary, because we want to apply the transformation to all main columns, which are selected by default.</p>
<p><img src="images/silac-03-transformation-param_window.png" class="img-fluid"></p>
<p>Then the ratios will be logarithmized by using the function <a href="transformationproc.html">Processing → Basic → Transform</a> again.</p>
<p><img src="images/silac-04-logarithmize-edited.png" class="img-fluid"></p>
<p>Now the transformation function we are going to use is <span class="math inline">\(log_2(x)\)</span>, which is the default setting. The transformation should also be applied to all main columns, which are selected by default.</p>
<p><img src="images/silac-04-logarithmize-parameter_window.png" class="img-fluid"></p>
</section>
<section id="renaming-columns" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="renaming-columns"><span class="header-section-number">2.4</span> Renaming columns</h2>
<p>The main column names “Ratio H/L Normalized …” are a bit bulky. So we rename the main columns with the help of regular expressions and the function <a href="renamecolumnsregexp.html">Processing → Rearrange → Rename columns [Reg.ex.]</a>.</p>
<p><img src="images/silac-06-renaming_regex-edited.png" class="img-fluid"></p>
<p>The regular expression that you may use to remove the repetitive part of the name is “Ratio H/L Normalized (.*)”. The general concept of regular expressions can be found under <a href="http://en.wikipedia.org/wiki/Regular_expression" class="uri">http://en.wikipedia.org/wiki/Regular_expression</a>. If you already know generally how regular expressions work, you may only need to glance at this <a href="http://msdn.microsoft.com/en-us/library/az24scfc.aspx">Quick Reference</a> or at an even quicker <a href="http://www.mikesdotnetting.com/Article/46/CSharp-Regular-Expressions-Cheat-Sheet">Cheat Sheet</a>.</p>
<p>This results in a matrix, where the column names of the ratios are a combination of the cell line and the replica.</p>
<p><img src="images/silac-06-renaming_regex-parameter_window.png" class="img-fluid"></p>
<p>If you want to rename the columns manually without the help of regular expressions you can use <a href="renamecolumns.html">Processing → Rearrange → Rename columns</a>.</p>
<p><img src="images/silac-06-renaming_manually-edited.png" class="img-fluid"></p>
<p>Then you can type the new names in the predefined text field.</p>
<p><img src="images/silac-06-renaming_manually-parameter_window.png" class="img-fluid"></p>
</section>
</section>
<section id="add-annotation" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Add annotation</h1>
<p>In <a href="addannotationtomatrix.html">Processing → Annot.columns → Add annotation</a> are several options for adding annotations to your data. You can select from any annotation file that is present in the “Perseus/conf/annotations/” folder.</p>
<p><img src="images/silac-07-add_annotation-edited.png" class="img-fluid"></p>
<p>The standard way of obtaining the latest main annotation, containing: GO, KEGG, Pfam, GSEA, Keywords, CORUM and many other terms found in UniProt is by downloading the mainPerseusAnnot.txt.gz file from dropbox. This is an easy four step process:</p>
<ul>
<li>Click on the blue box with the white arrow on the top left corner of the Preseus window</li>
<li>Select “Annotation download” and a pop-up window containing the dropbox link will appear</li>
<li>Click on the dropbox link and download the mainPerseusAnnot.txt.gz file of your choice</li>
<li>Put the downloaded file in the “Perseus/conf/annotations/” folder</li>
</ul>
<p><img src="images/silac-07-add_annotation-download-edited.png" class="img-fluid"></p>
<p>Since the dataset consists of three human breast cancer cell lines we have to download and use “mainAnnot.homo_sapiens.txt.gz” as “Source”. The mapping is always based on UniProt identifiers, therefore we have to specify which column contains the UniProt identifiers that should be used for mapping the annotation (parameter “Uniprot column”). Then we can select, which annotations should be added to the matrix. Here we select “GOBP name”, “GOMF name”, “GOCC name” and “KEGG name” by clicking on them on the left hand side and using the button in the middle with the arrow to the right.</p>
<p><img src="images/silac-07-add_annotation-parameter_window.png" class="img-fluid"></p>
<p>Now the matrix is filtered, transformed and everything is added that we want, so we can examine the data by using different visualization tools.</p>
</section>
<section id="scatter-plot" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Scatter plot</h1>
<p>Now we plot some replicates against each other. Therefore open a scatter plot with <a href="scatterplotanalysis.html">Analysis → Visualization → Scatter plot</a>.</p>
<p><img src="images/silac-08-scatter_plot-edited.png" class="img-fluid"></p>
<p>Then we plot different replicas against each other. For that we have to select “Columns” as “Matrix access”, which means that scatter plots between the columns will be calculated. This results in an extra tab on the same matrix containing the scatter plot functionalities.</p>
<p><img src="images/silac-08-scatter_plot-parameter_window.png" class="img-fluid"></p>
<p>Make sure you plot replicas of the same cell line against each other. The “Data” tab of the “Scatter plot” tab contains three different possibilities to explore the data in more detail defined by the tabs. Each of the three tabs has their own buttons, where the functionality of each button can be obtained from their tooltips:</p>
<ul>
<li><strong>Points</strong> contains the data points/proteins. Here selected proteins can be highlighted in the scatter plot by changing their color, shape or size.</li>
<li><strong>Categories</strong> contains the categories of the proteins e.g.&nbsp;the different annotation categories added in the previous step. Here selected categories can be highlighted in the scatter plot by changing their color, shape or size.</li>
<li><strong>Correlations</strong> contains a list of correlation coefficients that can be calculated up on request.</li>
</ul>
<p><img src="images/silac-08-scatter_plot-tab-edited.png" class="img-fluid"></p>
</section>
<section id="density-scatter-plot" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Density scatter plot</h1>
<p>When there are many data points in a scatter plot it is often difficult to see where the majority of points are located. This situation can be improved by coloring the data points by the local point density. Estimate the density for two columns with <a href="densityestimationprocessing.html">Processing → Basic → Density estimation</a>.</p>
<p><img src="images/silac-09-density_scatter_plot-edited.png" class="img-fluid"></p>
<p>Decide for two columns that you want to plot. No further changes are necessary. This results in an additional column containing the density estimate.</p>
<p><img src="images/silac-09-density_scatter_plot-parameter_window-03.png" class="img-fluid"></p>
<p>Now open a scatter plot,</p>
<p><img src="images/silac-08-scatter_plot-edited-02.png" class="img-fluid"></p>
<p>plot columns against each other,</p>
<p><img src="images/silac-08-scatter_plot-parameter_window-02.png" class="img-fluid"></p>
<p>and color the data points by the density that you just created. There are two options, either choose “Density_…” or “Excluded fraction_…” as color (highlighted by red rectangle). Data points with the highest density are light blue and data points with the lowest density are bright green (default). The color gradient can be changed in the scatter plot tab by clicking the button highlighted by a blue rectangle.</p>
<p><img src="images/silac-09-density_scatter_plot-plot-edited-01.png" class="img-fluid"></p>
</section>
<section id="multi-scatter-plot" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Multi scatter plot</h1>
<p>Open a multi scatter plot using <a href="multiscatteranalysis.html">Analysis → Visualization → Multi scatter plot</a>.</p>
<p><img src="images/silac-10-multi-scatter_plot-edited.png" class="img-fluid"></p>
<p>We want to plot all samples against each other. So no further changes are necessary, because all main columns are selected by default. The results will be displayed in an extra tab on the same matrix containing the multi scatter plot functionalities.</p>
<p><img src="images/silac-10-multi-scatter_plot-parameter_window.png" class="img-fluid"></p>
<p>Now to figure out, which of the samples have the best correlation we want to calculate the Pearson correlation (red rectangle) for every scatter plot. The results are written in blue on the left top corner of each scatter plot. Thus we can easily figure out, which cell lines are more similar to each other. Also other correlation coefficients can be calculated. All of these calculations will be saved in a matrix, which you can find in the “Plots” tab in the top right window of the “Multi scatter pot” tab. As before in the scatter plot also here you can change the point size/color of individual selected data points or of categories. To explore a specific scatter plot in more detail you can click on it and see it enlarged in the bottom right corner of Multi scatter plot tab (green rectangle).</p>
<p><img src="images/silac-10-multi-scatter_plot-plot-edited.png" class="img-fluid"></p>
</section>
<section id="histogram" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Histogram</h1>
<p>Open a histogram using <a href="histogram.html">Analysis → Visualization → Histogram</a>.</p>
<p><img src="images/silac-11-histogram-edited.png" class="img-fluid"></p>
<p>The log ratios of each sample are separately represented as histograms. Therefore, nothing needs to be changed in the parameters, because all main columns (samples) are selected by default. The results will be displayed in an extra tab on the same matrix containing the histogram functionalities.</p>
<p><img src="images/silac-11-histogram-parameter_window.png" class="img-fluid"></p>
<p>Here one can get an impression, if the overall ratio distributions are similar for all samples or if the distribution is peculiar in any way (e.g.&nbsp;bimodal). Histograms of sub-categories can be displayed by selecting one row (category) in the “Categories” table on the right side. Here the sub-category “amine metabolic process” is highlighted in orange, but also individual points can be selected in the “Points” table to see where they are located in all histograms.</p>
<p><img src="images/silac-11-histogram-plot.png" class="img-fluid"></p>
<p>If we switch to logarithmic fillings (button highlighted by the red rectangle) we are able to see the selected points better.</p>
<p><img src="images/silac-11-histogram-plot_log-edited.png" class="img-fluid"></p>
<p>In case the distributions are shifted towards left/right and the peak is not on zero, we have to normalize the values. For instance try normalizing the data by subtracting the median from each distribution with <a href="subtract.html">Processing → Normalization → Subtract</a> and check what changed by looking at the resulting histograms.</p>
<p><img src="images/silac-11-normalize_subtract-edited.png" class="img-fluid"></p>
<p>Set the parameter “Matrix access” to “Columns”.</p>
<p><img src="images/silac-11-normalize_subtract-parameter_window.png" class="img-fluid"></p>
<p>Afterwards open another histogram.</p>
<p><img src="images/silac-11-normalize_subtract-histogram-plot.png" class="img-fluid"></p>
</section>
<section id="profile-plot" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Profile plot</h1>
<p>Open a profile plot with <a href="profileplot.html">Analysis → Visualization → Profile plot</a>. The function has no parameters and the results will be displayed in an extra tab on the same matrix containing the profile plot functionalities.</p>
<p><img src="images/silac-12-profile_plot-edited.png" class="img-fluid"></p>
<p>Again you have tables with individual data points and categories where you can manipulate the properties of the lines. In addition there is the “Reference profile” tab. Here you can define what would be the shape of an expression profile of interest manually by shifting the profile points (red) up/down. Then you can retrieve those proteins (default: 10) whose expression profiles have the highest similarity or correlation to the reference profile by clicking on the “Select neighbours” button on upper left corner of the “Reference profile” tab (highlighted by the red rectangle).</p>
<p><img src="images/silac-12-profile_plot-plot_reference_tab-edited.png" class="img-fluid"></p>
<p>Also the profiles of particular proteins can be retrieved using the “Profiles” tab and highlighting the proteins of interest. Different coloring is also possible. To create the average expression profile of the selected proteins, go to the “Reference profile” tab and click the “Average selected profiles” button (button highlighted by a green rectangle in the screenshot above).</p>
<p><img src="images/silac-12-profile_plot-plot_profiles_tab-edited.png" class="img-fluid"></p>
<p>Or retrieve the average expression profile of a group of proteins (e.g.&nbsp;of a GO term) in the “Categories” tab. First highlight the categories of interest, then go to the “Reference profile” tab and click the “Average selected profiles” button (button highlighted by a green rectangle in the screenshot of the “Reference profile” tab).</p>
<p><img src="images/silac-12-profile_plot-plot_categories_tab-edited.png" class="img-fluid"></p>
<p>One can also input the values of the reference profile as numbers in the “Columns” tab. If you switch then back to the “Reference profile” tab, the displayed profile already contains the defined values.</p>
<p>Once you have found an interesting selection of proteins it can be exported (e.g.&nbsp;for enrichment analysis) with the “Export selection” button marked with a plus sign.</p>
</section>
<section id="d-scatter-plot" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> 3D scatter plot</h1>
<p>Open a 3D scatter plot with <a href="scatterplot3danalysis.html">Analysis → Visualization → 3D plot</a>. The function has no parameters and the results will be displayed in an extra tab on the same matrix containing the 3D scatter plot functionalities.</p>
<p><img src="images/silac-13-3d_scatter_plot-edited.png" class="img-fluid"></p>
<p>This is similar to the conventional scatter plot, just that you can plot three columns against each other. Also here one can color points, either directly, by categories or by another numerical column, which can result in quite appealing plots. If nothing happens you might have to hit the “Refresh” button in the upper left corner of the “3D plot” tab (highlighted by a red rectangle).</p>
<p><img src="images/silac-13-3d_scatter_plot-plot-edited.png" class="img-fluid"></p>
</section>
<section id="grouping-of-samples" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Grouping of samples</h1>
<p>Now we want to find out which proteins are differentially regulated between the cell lines. For this we have to define the grouping of samples into replicate groups. Go to <a href="createcategoricalannotrow.html">Processing → Annot.rows → Categorical annotation rows</a>.</p>
<p><img src="images/silac-14-grouping-edited.png" class="img-fluid"></p>
<p>Create three groups according to the replicates. The categorical column is named “Cell line” and the groups have the names of the cell lines, which are defined manually.</p>
<p><img src="images/silac-14-grouping-parameter_window.png" class="img-fluid"></p>
<p>In case you have more samples another opportunity is to use the Action “Create from experiment name”, which just works if the experiments are named properly.</p>
<p><img src="images/silac-14-grouping-parameter_window2.png" class="img-fluid"></p>
<p>If you export the data now using x<a href="tabseparatedexport.html">Export → Generic matrix export</a> and re-import it later with <a href="genericmatrixupload.html">Load → Generic matrix upload</a>, the grouping is still defined.</p>
</section>
<section id="numeric-venn-diagram" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Numeric Venn diagram</h1>
<p>On an unrelated note, we might be interested in the number of protein identifications we have in each sample (or in each cell line), how many of these are common to all samples and how many are unique for each sample. For simplicity we say now that a protein is present in a sample if there is a valid value for the ratio and we say that it is absent if the ratio is “NaN”. Since we are here only interested in absence/presence in a certain cell line and not so much in single replicates, we first average ratios within groups using <a href="averagegroups.html">Processing → Annot.rows → Average groups</a>.</p>
<p><img src="images/silac-15-venn_diagram-average_groups-edited.png" class="img-fluid"></p>
<p>Since our matrix just contains one categorical row, the default parameters can be used.</p>
<p><img src="images/silac-15-venn_diagram-average_groups-parameter_window.png" class="img-fluid"></p>
<p>Then when performing <a href="numericvenndiagram.html">Analysis → Misc.→ Numeric venn diagram</a> you will get some statistical information about the occurrence of proteins in the different cell lines. The results will be displayed in an extra tab on the same matrix containing the venn diagram functionalities.</p>
<p><img src="images/silac-15-venn_diagram-edited-01.png" class="img-fluid"></p>
<!--
# missing picture
{{ user:use_cases:silac-15-venn_diagram-parameter_window.png?direct \|}}
-->
<p>The “Total” tab of the window in the upper left corner (blue rectangle) contains information about the number of identified protein groups for each cell line, “Exclusive” contains the protein groups that are specific for each cell line (here none) and “Occurrence” is related to the “Combinations” tab in the lower left corner (orange rectangle), and shows the number of overlapping protein groups of the three cell lines. After selecting a row in the window highlighted in blue it is possible to see the members in the “Member” tab in the upper right corner (green rectangle). Enrichment analysis can be applied by clicking on the button in the upper left corner of the lower right window (purple rectangle). For the analysis the IDs on which the enrichment should be based on as well as the threshold can be specified.</p>
<p><img src="images/silac-15-venn_diagram-results-edited.png" class="img-fluid"></p>
</section>
<section id="anova" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> ANOVA</h1>
<p>To find out which proteins are differentially regulated between the cell lines go back to the matrix before “averaging within groups” and apply <a href="multiplesampletestprocessing.html">Processing → Tests → Multiple-samples tests</a>. We select “Multiple-samples tests” because there are more than two cell line groups to compare. In case you wanted to compare only one or two samples you would use the respective t-test.</p>
<p><img src="images/silac-16-anova-edited.png" class="img-fluid"></p>
<p>An important parameter in the parameter panel is “Use for truncation”. Here you can choose whether the truncation should be based on the p-values, if the Benjamini Hochberg correction for multiple hypothesis testing should be applied, or if a permutation-based FDR is calculated. As an example, if you select “Permutation-based FDR” and use 0.01 as a threshold value it would mean that there are 1% false positives among the proteins that the ANOVA test finds as significantly regulated.</p>
<p><img src="images/silac-16-anova-parameter_window.png" class="img-fluid"></p>
<p>The output table of ANOVA contains all proteins (not just the ones that are significantly changing). Two columns are added, one numerical column containing the -log(p-values) and one categorical column containing indications, if the respective row was significant in the test.</p>
<p><img src="images/silac-16-anova-output-edited-01.png" class="img-fluid"></p>
</section>
<section id="enrichment-fisher-exact-test" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Enrichment, Fisher exact test</h1>
<p>Now we want to know, if certain pathways or GO terms are over-represented in the proteins that are significantly changing between the cell lines. For this we can use the Fisher exact test in <a href="fisherexacttestproces.html">Processing → Annot.columns → Fisher exact test</a>.</p>
<p><img src="images/silac-17-enrichment_fisher_exact_test-edited.png" class="img-fluid"></p>
<p>It will test the terms in one column, in our case the column indicating ANOVA significance, if they correlate with terms from other categorical columns (e.g.&nbsp;KEGG pathways).</p>
<p><img src="images/silac-17-enrichment_fisher_exact_test-parameter_window.png" class="img-fluid"></p>
<p>Results will depend both on the stringency in the ANOVA as well as the stringency of the Fisher exact test. The output matrix contains all the significant categories with their number of hits, enrichment factors, p-values, corrected p-values, etc. It might be interesting to try different combinations of these. You can also apply the Fisher exact test immediately on the numerical column containing the -log(p-value).</p>
<p><img src="images/silac-17-enrichment_fisher_exact_test-output.png" class="img-fluid"></p>
</section>
<section id="hierarchical-clustering" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Hierarchical clustering</h1>
<p>First go to the matrix before averaging groups. Then as a preparation for the hierarchical clustering we first normalize the rows of the matrix. Use <a href="zscore.html">Processing → Normalization → Z-score</a>.</p>
<p><img src="images/silac-18-hierarchical_clustering-z-score-edited.png" class="img-fluid"></p>
<p>to perform Z-scoring of each row. This will shift the mean of each row to 0 and bring the standard deviation to 1.</p>
<p><img src="images/silac-18-hierarchical_clustering-z-score-parameter_window.png" class="img-fluid"></p>
<p>Now perform hierarchical clustering of rows and columns using <a href="hierarchicalcluster.html">Analysis → Clustering/PCA → Hierarchical clustering</a>.</p>
<p><img src="images/silac-18-hierarchical_clustering-edited.png" class="img-fluid"></p>
<p>You can use the default parameters. The results will be displayed in an extra tab on the same matrix containing the hierarchical clustering functionalities.</p>
<p><img src="images/silac-18-hierarchical_clustering-parameter_window.png" class="img-fluid"></p>
<p>{{ perseus:user:use_cases:silac-18-hierarchical_clustering-parameter_window.png?d irect |}}</p>
<p>Considering the column tree, the replicates of each cell line cluster nicely together. HCC1143 is more similar to HMEC than to HCC2218.</p>
<p><img src="images/silac-18-hierarchical_clustering-results-column_tree.png" class="img-fluid"></p>
<p>Considering the row tree, we have to zoom in by holding the left mouse key and dragging, to find a cluster of interest. To select a cluster click on the root of a sub tree and information about this cluster will be displayed in the windows next to the heatmap. The top right window contains the size of the cluster (blue rectangle). The window in the middle contains the profiles of the proteins within the cluster (green rectangle). And the window at the lower right enables enrichment analysis of the cluster by clicking on the button in the upper left corner of that window (orange rectangle). Explore the display options and the icon bar on top of the cluster heat map.</p>
<p><img src="images/silac-18-hierarchical_clustering-results-row_tree-edited.png" class="img-fluid"></p>
</section>
<section id="principal-component-analysis" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Principal component analysis</h1>
<p>In order to perform principal component analysis (PCA), all cells of the matrix have to contain valid values. One way to achieve this is to perform imputation, here we choose another method. We filter for valid values using <a href="filtervalidvaluesrows.html">Processing → Filter rows → Filter rows based on valid values</a> such that every row contains nine valid values. Go to the data matrix before Z-scoring and perform this valid value filtering.</p>
<p><img src="images/silac-19-pca-filtering-edited.png" class="img-fluid"></p>
<p><img src="images/silac-19-pca-parameter_window.png" class="img-fluid"></p>
<p>Then perform PCA with <a href="principalcomponentanalysis.html">Analysis → Clustering/PCA → Principal component analysis</a> and explore the results. The results will be displayed in an extra tab on the same matrix containing the principal component functionalities.</p>
<p><img src="images/silac-19-pca-edited.png" class="img-fluid"></p>
<p><img src="images/silac-19-pca-parameter_window-01.png" class="img-fluid"></p>
<p>The result contains the visual output of the PCA, which shows that the three cell lines are perfectly separated (upper left window - blue rectangle). The replicates of each cell line built a cluster. Color, size and shape of initially defined groups (“Categories” tab) or all data points (“Points” tab) can be manipulated in the upper right window (green rectangle). To figure out, which are the proteins that drive the separation of the cell lines, we have to look more closely into the plot in the lower left window (orange rectangle). First select the proteins/data points of interest and have a look at the “Point” tab of the lower right window (purple rectangle). Since we ticked the enrichment checkbox when applying the PCA, we can find the enrichment results in the “Categories” tab of the lower right window.</p>
<p><img src="images/silac-19-pca-results-edited.png" class="img-fluid"></p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-line-spacing="2" role="list">
<div id="ref-geiger2012" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Geiger, T., Madden, S. F., Gallagher, W. M., Cox, J. &amp; Mann, M. <a href="https://doi.org/10.1158/0008-5472.can-11-3711">Proteomic Portrait of Human Breast Cancer Progression Identifies Novel Prognostic Markers</a>. <em>Cancer Research</em> <strong>72</strong>, 2428–2439 (2012).</div>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2023, created by and maintained by Cox lab</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>