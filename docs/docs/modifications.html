<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.294">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Cox Lab">
<meta name="dcterms.date" content="2023-11-09">

<title>Label-free phospho data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./Figures/coxlab_logo2.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./maxquant_instructions.html" rel="" target="">
 <span class="menu-text">MaxQuant</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./perseus_instructions.html" rel="" target="">
 <span class="menu-text">Perseus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./andromeda_instructions.html" rel="" target="">
 <span class="menu-text">Andromeda</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="./contact.html" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/cox-labs/CoxLab_Bug_Reporting" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/TheCoxLab" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/juergen-cox-2437ba17/" rel="" target=""><i class="bi bi-fa-linkedin fa-lg" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="-1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#dataset" id="toc-dataset" class="nav-link active" data-scroll-target="#dataset"><span class="header-section-number">1</span> Dataset</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">2</span> Data preparation</a>
  <ul>
  <li><a href="#loading" id="toc-loading" class="nav-link" data-scroll-target="#loading"><span class="header-section-number">2.1</span> Loading</a></li>
  </ul></li>
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering"><span class="header-section-number">3</span> Filtering</a></li>
  <li><a href="#transformation" id="toc-transformation" class="nav-link" data-scroll-target="#transformation"><span class="header-section-number">4</span> Transformation</a>
  <ul>
  <li><a href="#renaming-columns" id="toc-renaming-columns" class="nav-link" data-scroll-target="#renaming-columns"><span class="header-section-number">4.1</span> Renaming columns</a></li>
  </ul></li>
  <li><a href="#add-annotation" id="toc-add-annotation" class="nav-link" data-scroll-target="#add-annotation"><span class="header-section-number">5</span> Add annotation</a></li>
  <li><a href="#add-modifications" id="toc-add-modifications" class="nav-link" data-scroll-target="#add-modifications"><span class="header-section-number">6</span> Add modifications</a></li>
  <li><a href="#grouping-of-samples" id="toc-grouping-of-samples" class="nav-link" data-scroll-target="#grouping-of-samples"><span class="header-section-number">7</span> Grouping of samples</a></li>
  <li><a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram"><span class="header-section-number">8</span> Histogram</a></li>
  <li><a href="#multi-scatter-plot" id="toc-multi-scatter-plot" class="nav-link" data-scroll-target="#multi-scatter-plot"><span class="header-section-number">9</span> Multi scatter plot</a></li>
  <li><a href="#imputation" id="toc-imputation" class="nav-link" data-scroll-target="#imputation"><span class="header-section-number">10</span> Imputation</a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova"><span class="header-section-number">11</span> ANOVA</a></li>
  <li><a href="#enrichment-fisher-exact-test" id="toc-enrichment-fisher-exact-test" class="nav-link" data-scroll-target="#enrichment-fisher-exact-test"><span class="header-section-number">12</span> Enrichment, Fisher exact test</a></li>
  <li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering"><span class="header-section-number">13</span> Hierarchical clustering</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Label-free phospho data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Cox Lab </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 9, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>

<p>For the here shown use case Perseus 1.5.1.6 was used.</p>
<section id="dataset" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Dataset</h1>
<p>The label-free phosphoproteomics data for the here shown example was published in 2014 by Sharma et al.<span class="citation" data-cites="sharma2014"><sup><a href="#ref-sharma2014" role="doc-biblioref">1</a></sup></span></p>
<p>This is label-free data for phosphorylation sites with six replicates of a control condition (C1,…,C6) and four replicates each of two treatments (E15_1,…,E15_4 and N1,…,N4).</p>
<p>The suffixes <code>_1</code>, <code>_2</code> and <code>_3</code> indicate data for the same sample and site derived from singly, double and triply or higher phosphorylated peptides.</p>
<p>(<em>The file “PhosphoExample_01.raw” was processed using MaxQuant version 1.5.2.0 and analyzed using Perseus version 1.5.1.6</em>)</p>
</section>
<section id="data-preparation" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data preparation</h1>
<section id="loading" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="loading"><span class="header-section-number">2.1</span> Loading</h2>
<p>Load the file “Phospho (STY)Sites.txt” from the “combined/txt” folder of the MaxQuant output. <a href="docs/genericmatrixupload.html">Load → Generic matrix upload</a> is denoted by the green arrow on the top left corner of the Perseus window or load the file using the drag and drop function of Perseus.</p>
<p><img src="images/phospho-01-generic_matrix_upload-edited.png" class="img-fluid"></p>
<p>Make sure to load the following 42 columns as <strong>main</strong> columns:</p>
<ul>
<li>Intensity C1_1, Intensity C1_2, Intensity C1_3,</li>
<li>Intensity C2_1, Intensity C2_2, Intensity C2_3,</li>
<li>Intensity C3_1, Intensity C3_2, Intensity C3_3,</li>
<li>Intensity C4_1, Intensity C4_2, Intensity C4_3,</li>
<li>Intensity C5_1, Intensity C5_2, Intensity C5_3,</li>
<li>Intensity C6_1, Intensity C6_2, Intensity C6_3,</li>
<li>Intensity E15_1_1, Intensity E15_1_2, Intensity E15_1_3,</li>
<li>Intensity E15_2_1, Intensity E15_2_2, Intensity E15_2_3,</li>
<li>Intensity E15_3_1, Intensity E15_3_2, Intensity E15_3_3,</li>
<li>Intensity E15_4_1, Intensity E15_4_2, Intensity E15_4_3,</li>
<li>Intensity N1_1, Intensity N1_2, Intensity N1_3,</li>
<li>Intensity N2_1, Intensity N2_2, Intensity N2_3,</li>
<li>Intensity N3_1, Intensity N3_2, Intensity N3_3,</li>
<li>Intensity N4_1, Intensity N4_2, Intensity N4_3</li>
</ul>
<p>Also make sure that the “Localization prob” is loaded as <strong>numerical</strong> column. (Only the global one, not one for each sample.)</p>
<p><em>Comment:</em> <em>After each applied operation a new matrix will be generated. Every matrix that you are creating can be saved with <a href="docs/tabseparatedexport.html">Export → Generic matrix export</a> and re-imported later with <a href="docs/genericmatrixupload.html">Load → Generic matrix upload</a>.</em></p>
</section>
</section>
<section id="filtering" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Filtering</h1>
<p>After loading the matrix, we filter out the reverse (decoy) database hits, the contaminants and the proteins with a localization probability <span class="math inline">\(&lt;0.75\)</span>. Both the “Reverse” column and the “Contaminant” column are categorical. Therefore we use <a href="docs/filtercategoricalcolumn.html">Processing → Filter rows → Filter rows based on categorical column</a>.</p>
<p><img src="images/phospho-03-filter_categorical_column-edited.png" class="img-fluid"></p>
<p>First, we filter out the reverse hits. Reverse hits are indicated by a “+” in the “Reverse” column, so to filter out these hits all rows containing a “+” will be removed from the matrix. To do so the column “Reverse” needs to be selected, “+” is the value we are looking for and is selected by default. No further changes are necessary, because we want to remove the matching rows from the matrix. This results in a matrix, where the value in the “Reverse” column of all rows is empty.</p>
<p><img src="images/phospho-03-filter_categorical_column-parameter_window-reverse.png" class="img-fluid"></p>
<p>Then, we filter out the contaminants. Contaminants are indicated by a “+” in the “Contaminant” column, so to filter out these hits all rows containing a “+” will be removed from the matrix. To do so the column “Contaminant” needs to be selected, “+” is the value we are looking for and is selected by default. No further changes are necessary, because we want to remove the matching rows from the matrix. This results in a matrix, where the value in the “Contaminant” column of all rows are empty.</p>
<p><img src="images/phospho-03-filter_categorical_column-parameter_window-contaminant.png" class="img-fluid"></p>
<p>Then we filter the site table to retain only these sites that have a localization probability <span class="math inline">\(&gt;0.75\)</span>. Therefore we use <a href="docs/filternumericalcolumn.html">Processing → Filter rows → Filter rows based on numerical/main column</a>.</p>
<p><img src="images/phospho-02-filter_num_column-edited.png" class="img-fluid"></p>
<p>For that filtering process we are just using the “Localization probability” column, one relation and have to specify the relation as shown in the screenshot below.</p>
<p><img src="images/phospho-02-filter_num_column-parameter_window.png" class="img-fluid"></p>
</section>
<section id="transformation" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Transformation</h1>
<p>Now we want to rearrange the main data. Currently, the different number of phosphorylations per peptide are formatted as separate columns. We want to have only one column per sample, and three rows per site instead. This is accomplished by <a href="docs/expandsitetable.html">Processing → Modifications → Expand site table</a>. The function has no parameters.</p>
<p><img src="images/phospho-04-expand_site_table-edited.png" class="img-fluid"></p>
<p>If you check the number of rows and the number of main columns in the two matrices before and after this step, you can see that the number of rows are tripled, whereas the number of main columns is one third. Also a categorical column called “Multiplicity” is generated, which contains information about the phosphorylation of the peptides (single, double, triply phosphorylated).</p>
<p>Now we proceed with the standard data processing steps and take the logarithm of values in the main columns with <a href="docs/transformationproc.html">Processing → Basic → Transform</a>.</p>
<p><img src="images/phospho-05-transform-edited.png" class="img-fluid"></p>
<p>Since the default formula is <span class="math inline">\(log_2(x)\)</span> and all main columns are selected, nothing needs to be changed.</p>
<p><img src="images/phospho-05-transform-parameter_window.png" class="img-fluid"></p>
<section id="renaming-columns" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="renaming-columns"><span class="header-section-number">4.1</span> Renaming columns</h2>
<p>Next, we are doing some cosmetics by shortening the names of the main columns and remove the prefix “Intensity” with <a href="docs/renamecolumnsregexp.html">Processing → Rearrange → Rename columns [reg. ex.]</a>.</p>
<p><img src="images/phospho-06-rename-regex-edited.png" class="img-fluid"></p>
<p>The regular expression that you may use to remove the repetitive part of the name is “Intensity (.*)”. The general concept of regular expressions can be found under <a href="http://en.wikipedia.org/wiki/Regular_expression" class="uri">http://en.wikipedia.org/wiki/Regular_expression</a>. If you already know generally how regular expressions work, you may only need to glance at this <a href="http://msdn.microsoft.com/en-us/library/az24scfc.aspx">Quick Reference</a> or at an even quicker <a href="http://www.mikesdotnetting.com/Article/46/CSharp-Regular-Expressions-Cheat-Sheet">Cheat Sheet</a>. This results in a matrix, where the names of the main columns are the replica.</p>
<p><img src="images/phospho-06-rename-regex-parameter_window.png" class="img-fluid"></p>
<p>If you want to rename the columns manually without the help of regular expressions you can use <a href="docs/renamecolumns.html">Processing → Rearrange → Rename columns</a>.</p>
<p><img src="images/phospho-06-rename-manually-edited-01.png" class="img-fluid"></p>
<p>Then you can type the new names in the predefined text field.</p>
<p><img src="images/phospho-06-rename-manually-parameter_window-02.png" class="img-fluid"></p>
</section>
</section>
<section id="add-annotation" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Add annotation</h1>
<p>Now we add protein annotations with <a href="docs/addannotationtomatrix.html">Processing → Annot. columns → Add annotation</a>. There are several options for adding annotations to your data. You can select from any annotation file that is present in the “Perseus/conf/annotations/” folder.</p>
<p><img src="images/phospho-07-add_annotation-edited.png" class="img-fluid"></p>
<p>The standard way of obtaining the latest main annotation, containing: GO, KEGG, Pfam, GSEA, Keywords, CORUM and many other terms found in UniProt is by downloading the mainPerseusAnnot.txt.gz file from dropbox. This is an easy four step process:</p>
<ul>
<li>Click on the blue box with the white arrow on the top left corner of the Perseus window</li>
<li>Select “Annotation download” and a pop-up window containing the dropbox link will appear</li>
<li>Click on the dropbox link and download the mainPerseusAnnot.txt.gz file of your choice</li>
<li>Put the downloaded file in the “Perseus/conf/annotations/” folder</li>
</ul>
<p><img src="images/phospho-07-add_annotation-download-edited.png" class="img-fluid"></p>
<p>Since the data set is human, we have to download and use “mainAnnot.homo_sapiens.txt.gz” as “Source”. The mapping is always based on UniProt identifiers, therefore we have to specify which column contains the UniProt identifiers that should be used for mapping the annotation (parameter “Uniprot column”). Here the column “Proteins” contains the UniProt identifiers. Then we can select, which annotations should be added to the matrix. Here we select the list from “GOBP name” to “Corum” by clicking on them on the left hand side and using the button in the middle with the arrow to the right.</p>
<p><img src="images/phospho-07-add_annotation-parameter_window.png" class="img-fluid"></p>
</section>
<section id="add-modifications" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Add modifications</h1>
<p>After adding protein specific annotations, we are now adding sequence specific annotations. Therefore we first have to download the files called “Kinase_Substrate_Dataset.gz” and “Phosphorylation_site_dataset.gz” from <a href="http://www.phosphosite.org/staticDownloads.do">PhosphoSitePlus</a>, unzip them and put them in the “Perseus/conf/PSP” folder. Now we can add the information to our identified sites.</p>
<p>First, we add site-specific sequence features with <a href="docs/addsequencefeatures.html">Processing → Modifications → Add sequence features</a>. Therefore we have to define the “Proteins” column containing the Uniprot identifiers and the position of the modification within proteins (“Position within protein”). This results in matrix with a lot of additional columns containing sequence specific information like zinc-finger region or signal peptide.</p>
<p><img src="images/phospho-08-modifications-add_sequence_features-edited.png" class="img-fluid"></p>
<p><img src="images/phospho-08-modifications-add_sequence_features-parameter_window.png" class="img-fluid"></p>
<p>Second, we add linear motifs utilizing the Sequence window of the modification, which you can find in the text column called “Sequence window”. Hence we use the function <a href="docs/addlinearmotifs.html">Processing → Modifications → Add linear motifs</a>. The results will be displayed in the column “Motifs” in the resulting matrix. The motifs derive from the “motifs.txt” file located in the “Perseus/conf” folder. In case you have additional motifs that should be searched in the identified sites, you can edit the “motifs.txt” file.</p>
<p><img src="images/phospho-08-modifications-add_linear_motif-edited.png" class="img-fluid"></p>
<p><img src="images/phospho-08-modifications-add_known_sites-parameter_window.png" class="img-fluid"></p>
<p>Third, we add known sites with <a href="docs/addknownsites.html">Processing → Modifications → Add known sites</a>. We are interested in phosphorylation and define them as “Modification”. Also we have to define the column, which contains the Uniprot identifier (“Uniprot column”) and the column containing the sequence window.</p>
<p><img src="images/phospho-08-modifications-add_known_sites-edited.png" class="img-fluid"></p>
<p><img src="images/phospho-08-modifications-add_known_sites-parameter_window-01.png" class="img-fluid"></p>
<p>And last but not least, we add known kinase-substrate relations with the function <a href="docs/kinasesubstraterelations.html">Processing → Modifications → Kinase-substrate relations</a>. For that we specify the column containing the Uniprot identifier (“Uniprot column”) and the one containing the sequence window.</p>
<p><img src="images/phospho-08-modifications-kinase-substrate_relations-edited.png" class="img-fluid"></p>
<p><img src="images/phospho-08-modifications-kinase-substrate_relations-parameter_window.png" class="img-fluid"></p>
</section>
<section id="grouping-of-samples" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Grouping of samples</h1>
<p>Define a sample grouping according to C, E15 and N using <a href="docs/createcategoricalannotrow.html">Processing → Annotation rows → Categorical annotation rows</a>.</p>
<p><img src="images/phospho-09-categorical_annotation_rows-edited.png" class="img-fluid"></p>
<p>You can leave the name of the grouping to the default value “Group1” and just shorten the rest of the column names to the same prefix. Also giving each group a different name is possible, this is a matter of taste.</p>
<p><img src="images/phospho-09-categorical_annotation_rows-parameter_window.png" class="img-fluid"></p>
<p>Also this is a good time to save a backup matrix <a href="tabseparatedexport">Export → Generic matrix export</a>.</p>
<p><img src="images/phospho-10-generic_matrix_export-edited.png" class="img-fluid"></p>
<p>Next, rows without any valid values in the main columns won’t be particularly useful for quantitative analysis, therefore we can remove them by filtering <a href="docs/filtervalidvaluesrows.html">Processing → Filter rows → Filter rows based on valid values</a>.</p>
<p><img src="images/phospho-11-filter_valid_values-edited.png" class="img-fluid"></p>
<p>There are different filtering strategies available. Think about what kind of valid value filtering makes most sense for this kind of data. Now that we have created sample grouping, we can take advantage of these groups for filtering purposes. So we want in at least one group 4 valid values. This makes particularly sense, because we are interested in the cases where one stimulus results in a lot of phospho sites in comparison to the control or the other stimulus.</p>
<p>And just as a comment, the fact that we have 4 replicas of each stimulus makes our filtering strategy quite strict and we are very certain about the identification after this filtering step.</p>
<p><img src="images/phospho-11-filter_valid_values-parameter_window.png" class="img-fluid"></p>
<p>Now the matrix is filtered, transformed, samples are grouped and everything is added that needed to be added, so we can examine the data by using different visualization tools.</p>
</section>
<section id="histogram" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Histogram</h1>
<p>Now let’s look at some histograms of the data. Use <a href="docs/histogram.html">Analysis → Visualization → Histogram</a>.</p>
<p><img src="images/phospho-12-histogram-edited.png" class="img-fluid"></p>
<p>Each sample is separately represented by a histogram. Therefore, nothing needs to be changed in the parameters, because all main columns (samples) are selected by default. The results will be displayed in an extra tab on the same matrix containing the histogram functionalities.</p>
<p><img src="images/phospho-12-histogram-parameter_window.png" class="img-fluid"></p>
<p>This can be useful to visualize the spread of the data and to determine, if the data might benefit from some normalization. Also histograms of sub-categories can be displayed by selecting one row (category) in the “Categories” table on the right side. Here the sub-category “anatomical structure morphogenesis” is highlighted in orange, but also individual points can be selected in the “Points” table to see where they are located in all histograms. In this case the data is well centered and does not need to be normalized.</p>
<p><img src="images/phospho-12-histogram-plot.png" class="img-fluid"></p>
<p>Nevertheless, for demonstration, you could subtract the median of each column with <a href="docs/subtract.html">Processing → Normalization → Subtract</a>.</p>
<p><img src="images/phospho-12-histogram-normalization_subtract-edited.png" class="img-fluid"></p>
<p>Set the parameter “Matrix access” to “Columns”.</p>
<p><img src="images/phospho-12-histogram-normalization_subtract-parameter_window.png" class="img-fluid"></p>
<p>And make new histograms afterwards to see the effect of normalization. Now the data is centered around 0.</p>
<p><img src="images/phospho-12-histogram-normalization_subtract-plot.png" class="img-fluid"></p>
</section>
<section id="multi-scatter-plot" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Multi scatter plot</h1>
<p>Now open a scatter plot or a multi scatter plot to see, if you are happy with the correlation between replicates. Here we use a multi scatter plot <a href="docs/multiscatteranalysis.html">Analysis → Visualization → Multi scatter plot</a>, because it gives us a great overview in one figure. Also correlation coefficients can be calculated for each plot. Before you do this remind yourself that this is label free data, which may calibrate your expectations to low values.</p>
<p><img src="images/phospho-13-multi-scatter-plot-edited.png" class="img-fluid"></p>
<p>We want to plot all samples against each other. So no further changes are necessary, because all main columns are selected by default. The results will be displayed in an extra tab on the same matrix containing the multi scatter plot functionalities.</p>
<p><img src="images/phospho-13-multi-scatter-plot-parameter_window.png" class="img-fluid"></p>
<p>Now to figure out, which of the replicates have the best correlation we want to calculate the Pearson correlation (red rectangle) for every scatter plot. The results are written in blue on the left top corner of each scatter plot. Thus we can easily figure out, that replicate correlations are high and there are changes between control and the two treatments.</p>
<p><img src="images/phospho-13-multi-scatter-plot-plot-edited.png" class="img-fluid"></p>
</section>
<section id="imputation" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Imputation</h1>
<p>It is recommended to impute missing values after filtering, thus we don’t have any missing values in the data for further analyses. Therefore use <a href="docs/replacemissingfromgaussian.html">Processing → Imputation → Replace missing values from normal distribution</a>.</p>
<p><img src="images/phospho-14-imputation-edited.png" class="img-fluid"></p>
<p>We want to replace missing values in all columns (replicates) separately, which are the default values. Also the default values for “Width” and “Down shift” are fine. To find the optimal values you can check different values for the “Down shift” and the “Width” parameter and view your results in the histograms.</p>
<p><img src="images/phospho-14-imputation-parameter_window.png" class="img-fluid"></p>
<p>Plot a histogram using <a href="docs/histogram.html">Analysis → Visualization → Histogram</a> to view the results of the imputation. After selecting “Selection from imputation” in “Plots” tab of the “Histogram” tab (red rectangle), the imputed values are highlighted in orange in each histogram. We can see that these values are down shifted and their distribution is narrower, but their overall shape is the same one as the shape of the column we imputed. The assumption here is that the sites that we weren’t able to identify using the matching between runs algorithm are most likely low abundant in the sample and should therefore be on the lower end of the distribution.</p>
<p><img src="images/phospho-14-imputation-histograms-edited.png" class="img-fluid"></p>
</section>
<section id="anova" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> ANOVA</h1>
<p>To find sites that are changing between the three groups we perform an ANOVA test with <a href="docs/multiplesampletestprocessing.html">Processing → Tests → Multiple samples</a>. We select “Multiple-samples tests”, because there are more than two groups to compare. In case you wanted to compare only one or two samples you would use the respective t-test.</p>
<p><img src="images/phospho-15-anova-edited.png" class="img-fluid"></p>
<p>An important parameter in the parameter panel is “Use for truncation”. Here you can choose whether the truncation should be based on the p-values, if the Benjamini Hochberg correction for multiple hypothesis testing should be applied, or if a permutation-based FDR is calculated. As an example, if you select “Permutation-based FDR” and use 0.01 as a threshold value it would mean that there are 1% false positives among the proteins that the ANOVA test finds as significantly regulated.</p>
<p><img src="images/phospho-15-anova-parameter_window.png" class="img-fluid"></p>
<p>The resulting matrix contains two new columns, one categorical column called “ANOVA Significant” and one numerical column called “-Log ANOVA p value”.</p>
<p><img src="images/phospho-15-anova-resulting_matrix-edited.png" class="img-fluid"></p>
</section>
<section id="enrichment-fisher-exact-test" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Enrichment, Fisher exact test</h1>
<p>Now check which annotation terms are enriched in the changing sites. For this we use a Fisher exact test <a href="docs/fisherexacttestproces.html">Processing → Annot. columns → Fisher exact test</a>.</p>
<p><img src="images/phospho-16-fisher-edited.png" class="img-fluid"></p>
<p>Select the “ANOVA significant” column. It is important here to select “Proteins” for the “Relative enrichment” parameter. It means that multiple sites on the same protein are counted only once in the enrichment calculations. This prevents an enrichment from becoming significant simply due to the presence of multiple phosphorylation sites on a single protein.</p>
<p><img src="images/phospho-16-fisher-parameter_window.png" class="img-fluid"></p>
<p>Results will depend both on the stringency in the ANOVA as well as the stringency of the Fisher exact test. The output matrix contains all the significant categories with their number of hits, enrichment factor, p-values, corrected p-values, etc. It might be interesting to try different combinations of these. You can also apply the Fisher exact test immediately on the numerical column containing the -log(p-value).</p>
<p><img src="images/phospho-16-fisher-results.png" class="img-fluid"></p>
</section>
<section id="hierarchical-clustering" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Hierarchical clustering</h1>
<p>Next we want to explore the results, in particular look at enrichments of annotation terms in some clusters. So first we create a matrix with only the significant ANOVA sites using <a href="filtercategoricalcolumn">Processing → Filter rows → Filter rows based on categorical column</a>.</p>
<p><img src="images/phospho-17-clustering-filtering-edited-01.png" class="img-fluid"></p>
<p>Significant ANOVA hits are indicated by a “+” in the “ANOVA Significant” column, so to retain these hits all rows containing a “+” will be kept. Therefore, the column “ANOVA Significant” needs to be selected, “+” is the value we are looking for and is selected by default. For the “Mode” parameter we have to select “Keep matching rows”. This results in a matrix, where the value in the “ANOVA Significant” column of all rows contain a “+”.</p>
<p><img src="images/phospho-17-clustering-filtering-parameter_window.png" class="img-fluid"></p>
<p>Second we are performing Z-scoring of rows with <a href="docs/zscore.html">Processing → Normalization → Z-score</a>.</p>
<p><img src="images/phospho-17-zscore-edited.png" class="img-fluid"></p>
<p>The default parameters are fine for the example shown here. This will shift the mean of each row to 0 and bring the standard deviation to 1.</p>
<p><img src="images/phospho-17-zscore-parameter_window.png" class="img-fluid"></p>
<p>And finally we use hierarchical clustering <a href="docs/hierarchicalcluster.html">Analysis → Clustering/PCA → Hierarchical clustering</a> to visualize the cluster of the data.</p>
<p><img src="images/phospho-17-hierachical_clustering-edited.png" class="img-fluid"></p>
<p>with the default parameters, since the right columns are selected.</p>
<p><img src="images/phospho-17-hierachical_clustering-parameter_window.png" class="img-fluid"></p>
<p>Considering the column tree, the control replicates as well as the replicates of each treatment cluster nicely together.</p>
<p><img src="images/phospho-17-hierachical_clustering-column_tree.png" class="img-fluid"></p>
<p>Considering the row tree, we have to zoom in by holding the left mouse key and dragging, to find a cluster of interest. To select a cluster click on the root of a sub tree and information about this cluster will be displayed in the windows next to the heatmap. The top right window contains the size of the cluster (blue rectangle). The window in the middle contains the profiles of the proteins within the cluster (green rectangle). And the window at the lower right enables enrichment analysis of the cluster by clicking on the button in the upper left corner of that window (orange rectangle). Since we analyze phospho data, which means we are interested in site specific enrichment, it is important that we use “Proteins” for the “Relative enrichment” parameter (red rectangle in the orange box). It means that multiple sites on the same protein are counted only once in the enrichment calculations. This prevents an enrichment from becoming significant simply due to the presence of multiple phosphorylation sites on a single protein.</p>
<p><img src="images/phospho-17-hierachical_clustering-row_tree-edited.png" class="img-fluid"></p>
<p>There are many more ways to further explore the data. If you have time try e.g.&nbsp;<a href="docs/principalcomponentanalysis.html">Analysis → Clustering/PCA → Principal component analysis</a>. Note that principal component analysis is best done without prior z-scoring of the data.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-line-spacing="2" role="list">
<div id="ref-sharma2014" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Sharma, K. <em>et al.</em> <a href="https://doi.org/10.1016/j.celrep.2014.07.036">Ultradeep Human Phosphoproteome Reveals a Distinct Regulatory Nature of Tyr and Ser/Thr-Based Signaling</a>. <em>Cell Reports</em> <strong>8</strong>, 1583–1594 (2014).</div>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2023, created by and maintained by Cox lab</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>